extends layout

block content
    link(rel='stylesheet' href='/stylesheets/messages.css')
    script(src='/javascripts/jquery-3.2.1.min.js')
    style.
        .error {
            color: #c00;
        }
        form label {
            padding-left: 15px;
            padding-right: 5px;
            margin: 0;
            }
        input[type="submit"] {
            display: block;
            margin-top: 25px;
            margin-left: 15px;
        }
        .remove-student {
            margin-left: 15px;
            margin-right: 5px;
        }
        #add-student {
            margin-top: 2ex;
        }
        .hidden {
            display: none;
        }
    script.
        $(document).ready(function() {
            var  maxTeamSize = #{studentData.maxTeamSize}
            function showOrHide(w, condition) {
                w[condition ?   'show' :   'hide']('fast')
            }
            function addStudent() {
                var students = $('#students')
                var teamSize = students.children().length
                if (teamSize >= maxTeamSize)
                    return msg.error('Достигнут максимальный размер команды!')
                $('#studentLoginDataTemplate')
                    .clone(true)
                    .prop('id', '')
                    .appendTo(students)
                    .show('fast')
                    .find('.student-ordinal').text(teamSize+1)
                
                ++teamSize
                showOrHide($('#add-student'), teamSize < maxTeamSize)
                showOrHide($('.remove-student'), teamSize > 1)
            }
            addStudent()
            $('#add-student').click(addStudent)
            $('.remove-student').click(function() {
                var teamSize = $('#students').children().length
                if (teamSize < 2)
                return msg.error('Достигнут минимальный размер команды!')
                $(this).parent().hide('fast', function() { this.remove() })
                --teamSize
                showOrHide($('#add-student'), teamSize < maxTeamSize)
                showOrHide($('.remove-student'), teamSize > 1)
            })
        })


    h1 Идентификация
    p Введите, пожалуйста, свои данные
    if message && message.length > 0
        p.error!= message.join('<br/>')
    form(action='login' method='POST')
        label(for='group') Номер группы
        input(type='text' name='group' value=loginData.group autofocus)
        #students
        input.hidden#add-student(type='button' value='Добавить студента')
        input(type='submit' value='Войти')
    .hidden#studentLoginDataTemplate
        p Студент&nbsp;
            span.student-ordinal [[N]]
        label(for='firstname') Имя
        input(type='text' name='firstname' value=loginData.firstname)
        label(for='lastname') Фамилия
        input(type='text' name='lastname' value=loginData.lastname)
        input.remove-student(type='button' name='remove' value='Удалить студента')
